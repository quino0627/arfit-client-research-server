# Migration `20200427143751-init`

This migration has been generated by quino0627 at 4/27/2020, 2:37:52 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `arfit-research`.`Exercise` ADD COLUMN `machineId` int  ,
ADD COLUMN `name` varchar(191) NOT NULL  ,
ADD COLUMN `questId` int  ;

ALTER TABLE `arfit-research`.`Machine` ADD COLUMN `description` varchar(191) NOT NULL  ,
ADD COLUMN `name` varchar(191) NOT NULL  ;

ALTER TABLE `arfit-research`.`Quest` DROP FOREIGN KEY `Quest_ibfk_1`,
DROP COLUMN `userId`,
ADD COLUMN `isDone` boolean NOT NULL  ,
ADD COLUMN `playerId` int NOT NULL ,
ADD COLUMN `reps` int NOT NULL  ,
ADD COLUMN `sets` int NOT NULL  ,
ADD COLUMN `weight` int NOT NULL  ,
ADD COLUMN `when` datetime(3) NOT NULL  ;

ALTER TABLE `arfit-research`.`User` ADD COLUMN `role` ENUM('User', 'ADMIN') NOT NULL  ;

ALTER TABLE `arfit-research`.`Exercise` ADD FOREIGN KEY (`machineId`) REFERENCES `arfit-research`.`Machine`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `arfit-research`.`Exercise` ADD FOREIGN KEY (`questId`) REFERENCES `arfit-research`.`Quest`(`id`) ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE `arfit-research`.`Quest` ADD FOREIGN KEY (`playerId`) REFERENCES `arfit-research`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200423221412-init..20200427143751-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "mysql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -13,21 +13,36 @@
   createdAt   DateTime  @default(now())
   lastLoginAt DateTime?
   loginWhere  String?
   QuestList   Quest[]
+  role        Role
 }
 model Quest {
-  id     Int  @default(autoincrement()) @id
-  userId Int?
+  id       Int        @default(autoincrement()) @id
+  player   User       @relation(fields: [playerId], references: [id])
+  playerId Int
+  exercise Exercise[]
+  sets     Int
+  reps     Int
+  weight   Int
+  when     DateTime
+  isDone   Boolean
 }
 model Exercise {
-  id Int @default(autoincrement()) @id
+  id        Int      @default(autoincrement()) @id
+  name      String
+  machine   Machine? @relation(fields: [machineId], references: [id])
+  machineId Int?
+  questId   Int?
 }
 model Machine {
-  id Int @default(autoincrement()) @id
+  id                 Int        @default(autoincrement()) @id
+  name               String
+  description        String
+  availableExercises Exercise[]
 }
 enum Role {
   User
```


